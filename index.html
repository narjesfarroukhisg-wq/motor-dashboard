<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Industrial Motor Supervision</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>

if(localStorage.getItem("loggedIn")!=="true"){
    window.location.href="login.html";
}

</script>

<style>
body{
    margin:0;
    font-family:Arial;
    background:#0f172a;
    color:white;
}

/* TOP BAR */
.topbar{
    background:#1e293b;
    padding:15px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.topbar .right span{
    margin-left:20px;
}

/* BUTTONS */
.btn{
    padding:8px 15px;
    border:none;
    border-radius:8px;
    cursor:pointer;
}

.live{background:#16a34a;color:white;}
.history{background:#2563eb;color:white;}
.danger{background:red;color:white;}

/* CARDS */
.container{
    padding:20px;
}

.cards{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:15px;
}

.card{
    background:#1e293b;
    padding:20px;
    border-radius:15px;
    text-align:center;
}

/* SECTIONS */
.section{
    margin-top:30px;
    background:#1e293b;
    padding:20px;
    border-radius:15px;
}
</style>
</head>

<body>

<div class="topbar">
    <div>
        <strong>Motor Supervision System</strong>
    </div>
    <div class="right">
        ðŸŒ¡ <span id="weather">22Â°C</span>
        ðŸ“… <span id="date"></span>
        ðŸ•’ <span id="time"></span>
        <button onclick="logout()">Logout</button>
        <button class="btn live">Live</button>
        <button class="btn history" onclick="window.location.href='historique.html'">Historique</button>
    </div>
</div>

<div class="container">

<!-- VALEURS -->
<div class="cards">
    <div class="card">
        <h3>Courant</h3>
        <h2 id="current">5 A</h2>
    </div>

    <div class="card">
        <h3>Tension</h3>
        <h2 id="voltage">220 V</h2>
    </div>

    <div class="card">
        <h3>TempÃ©rature</h3>
        <h2 id="temp">35 Â°C</h2>
    </div>

    <div class="card">
        <h3>Vibration</h3>
        <h2 id="vibration">2.1 mm/s</h2>
    </div>
</div>

<!-- GRAPHIQUE -->
<div class="section">
    <h3>Courbe Vibration</h3>
    <canvas id="vibChart"></canvas>
</div>

<!-- ALARMES -->
<div class="section">
    <h3>Alarmes & Messages</h3>
    <div id="messages">SystÃ¨me stable.</div>
</div>

<!-- CONTROL -->
<div class="section">
    <h3>ContrÃ´le Ã  distance</h3>
    <button class="btn">ON</button>
    <button class="btn">OFF</button>
    <button class="btn danger">ArrÃªt d'urgence</button>
</div>

</div>

<script>


// ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ (simulation)
setInterval(()=>{

    let now = new Date();

    let data = {
        date: now.toLocaleDateString(),
        time: now.toLocaleTimeString(),
        temp: document.getElementById("temp").innerText,
        current: document.getElementById("current").innerText,
        voltage: document.getElementById("voltage").innerText,
        vibration: document.getElementById("vibration").innerText
    };

    let history = JSON.parse(localStorage.getItem("motorHistory")) || [];
    history.push(data);

    localStorage.setItem("motorHistory", JSON.stringify(history));

},10000); // ÙƒÙ„ 10 Ø«ÙˆØ§Ù†ÙŠ



/* DATE & TIME */
setInterval(()=>{
    let now=new Date();
    document.getElementById("date").innerHTML=now.toLocaleDateString();
    document.getElementById("time").innerHTML=now.toLocaleTimeString();
},1000);

/* CHART */
const ctx=document.getElementById('vibChart').getContext('2d');
const vibChart=new Chart(ctx,{
    type:'line',
    data:{
        labels:["1","2","3","4","5","6"],
        datasets:[{
            label:"Vibration",
            data:[2,3,2.5,4,3.5,5],
            borderColor:"cyan",
            fill:false
        }]
    }
});

function logout(){
    localStorage.removeItem("loggedIn");
    window.location.href="login.html";
}

</script>

<script>

// ===== SAVE DATA PAR JOUR =====

function saveData(){

let now=new Date();

let data={
date:now.toLocaleDateString(),
time:now.toLocaleTimeString(),
temp:(30+Math.random()*15).toFixed(1),
current:(4+Math.random()*3).toFixed(2),
voltage:(210+Math.random()*20).toFixed(0),
vibration:(1+Math.random()*5).toFixed(2)
};

let archive=
JSON.parse(localStorage.getItem("motorArchive"))||{};

let today=data.date;

if(!archive[today]){
archive[today]=[];
}

archive[today].push(data);

localStorage.setItem(
"motorArchive",
JSON.stringify(archive)
);

}

// sauvegarde chaque 10 sec
setInterval(saveData,10000);

</script>
</body>
</html>